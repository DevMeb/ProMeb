import{s as F,e as S,c as n,a as r,b as e,d as T,f as v,h as y,u as t,F as P,i as $,t as a,n as j,o as R,r as A,j as z,g as w,k as M,v as B,l as N}from"./app-D1nYlzh5.js";import{u as D,_ as H,a as U,b as q}from"./FactureFormModal-Cc91p2bh.js";import{u as I}from"./prestations-Dbaj7vns.js";/* empty css            */const L={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},E={__name:"PrestationsStatistiques",setup(l){const u=D(),{dashboardData:c}=F(u),g=S(!1),d=S(!1),b=S(!1),f=S(!1);return(m,i)=>(r(),n(P,null,[e("div",L,[y(t(k),{title:"Activité totale",value:t(c).prestations.length,description:"Total des prestations",icon:"📦",gradient:"from-indigo-500 to-indigo-600",textColor:"text-indigo-100",onClick:i[0]||(i[0]=x=>g.value=!0)},null,8,["value"]),y(t(k),{title:"Prestations en attente de facturation",value:t(c).prestations_unbilled.length,description:"Prestations en attente de facturation",icon:"⏳",gradient:"from-orange-400 to-orange-500",textColor:"text-orange-100",onClick:i[1]||(i[1]=x=>d.value=!0)},null,8,["value"]),y(t(k),{title:"Factures payées",value:t(c).factures_paid.length,description:"Factures régularisées",icon:"📑",gradient:"from-green-500 to-green-600",textColor:"text-green-100",onClick:i[2]||(i[2]=x=>b.value=!0)},null,8,["value"]),y(t(k),{title:"Factures non payées",value:t(c).factures_unpaid.length,description:"Factures en attente de facturation",icon:"⏳",gradient:"from-red-400 to-red-700",textColor:"text-orange-100",onClick:i[3]||(i[3]=x=>f.value=!0)},null,8,["value"])]),d.value?(r(),T(t(H),{key:0,onClose:i[4]||(i[4]=x=>d.value=!1)})):v("",!0),g.value?(r(),T(t(we),{key:1,onClose:i[5]||(i[5]=x=>g.value=!1)})):v("",!0),b.value?(r(),T(t(V),{key:2,factures:t(c).factures_paid,title:"Factures payées",onClose:i[6]||(i[6]=x=>b.value=!1)},null,8,["factures"])):v("",!0),f.value?(r(),T(t(V),{key:3,factures:t(c).factures_unpaid,title:"Factures non payées",onClose:i[7]||(i[7]=x=>f.value=!1)},null,8,["factures"])):v("",!0)],64))}},W={class:"flex items-center mb-4 relative z-10"},G={class:"text-4xl mr-3 drop-shadow-md"},J={class:"text-xl font-semibold text-white drop-shadow-md"},K={class:"text-4xl font-bold text-white mb-2 drop-shadow-md relative z-10"},O={key:0,class:"pl-4"},Q={class:"text-sm text-white/80 relative z-10"},X={key:0,class:"absolute top-3 right-3 backdrop-blur-sm bg-red-400 text-white/90 text-xs font-medium px-3 py-1.5 rounded-full shadow-sm border border-red-500"},k={__name:"DashboardCard",props:{title:String,value:[String,Number],description:String,icon:String,gradient:String,badge:Number,taxe:Number,afterTaxe:Number,isDifference:Boolean,cursor:Boolean},setup(l){const u=l,c=$(()=>u.title.includes("CA")?`${Number(u.value).toLocaleString("fr-FR")} €`:u.value),g=$(()=>u.value>=0?"text-green-300":"text-red-300"),d=$(()=>u.value>=0?"▵":"▿");return $(()=>u.badge.includes("✔")?"border-green-600/30 text-green-300":u.badge.includes("⚠")?"border-orange-500/30 text-amber-300":"border-gray-500/30"),(b,f)=>(r(),n("div",{class:j(`bg-gradient-to-tr ${l.gradient} p-6 rounded-xl shadow-xl transform transition-all hover:scale-[1.02] hover:cursor-pointer hover:shadow-2xl relative overflow-hidden`)},[f[0]||(f[0]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"},null,-1)),e("div",W,[e("span",G,a(l.icon),1),e("h2",J,a(l.title),1)]),e("p",K,[e("span",{class:j({"line-through text-gray-400":l.title==="CA facturé"&&l.taxe>0})},a(c.value),3),l.title==="CA facturé"&&l.taxe>0?(r(),n("span",O,a(l.afterTaxe)+" € ",1)):v("",!0),l.isDifference?(r(),n("span",{key:1,class:j(`text-lg ml-2 ${g.value}`)},a(d.value),3)):v("",!0)]),e("p",Q,a(l.description),1),l.title==="CA facturé"&&l.taxe>0?(r(),n("div",X," -"+a(l.taxe)+" % ",1)):v("",!0)],2))}},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},Z={__name:"CAStatistiques",setup(l){const u=D(),{dashboardData:c,taxe:g,caBilledWithTax:d,caBilled:b,caAttendu:f,difference:m}=F(u);return(i,x)=>(r(),n("div",Y,[y(k,{title:"CA facturé",value:t(b),taxe:t(g),afterTaxe:t(d),badge:t(g),badgeColor:"text-red-500",description:"Revenus confirmés",icon:"💶",gradient:"from-green-600 to-green-700"},null,8,["value","taxe","afterTaxe","badge"]),y(k,{title:"CA attendu",value:t(f),description:"Revenus prévisionnels",icon:"📈",gradient:"from-amber-500 to-amber-600"},null,8,["value"]),y(k,{title:"Écart",value:t(m),description:"Différence CA réel/prévisionnel",icon:"⚖️",gradient:t(m)>=0?"from-green-600 to-green-700":"from-red-500 to-red-600",isDifference:!0},null,8,["value","gradient"])]))}},ee={class:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-md z-50"},te={class:"bg-gray-900 p-8 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-auto border border-gray-800"},se={class:"mt-6"},re={key:0,class:"p-6 text-center rounded-xl border-2 border-dashed border-gray-800 hover:border-indigo-500 transition-colors"},oe={key:1,class:"space-y-3"},ne={class:"ml-4 flex-1"},ae={class:"flex items-center justify-center gap-3"},le={class:"font-bold text-md bg-gray-900 text-gray-400 px-2 py-1 rounded-full"},ie={class:"grid grid-cols-2 gap-2 mt-2 font-bold"},de={class:"flex items-center justify-center gap-2 text-lg"},ue={class:"text-gray-300"},ce={class:"flex items-center justify-center gap-2 text-lg"},ge={class:"text-gray-300 truncate"},xe={class:"flex items-center justify-center gap-2 text-lg"},fe={class:"text-gray-300 truncate"},be={class:"flex items-center justify-center gap-2 text-lg"},me={class:"text-gray-300 truncate"},pe={key:0,class:"mt-6 bg-gray-800 p-4 rounded-xl border border-gray-700"},ve={class:"space-y-2"},he={class:"flex justify-between items-center"},ye={class:"text-indigo-400 font-bold"},_e={class:"flex justify-between items-center"},$e={class:"text-green-400 font-bold"},we={__name:"PrestationsModal",emits:["close"],setup(l,{emit:u}){const c=u,g=I(),{prestations:d}=F(g),{fetchPrestations:b}=g;R(()=>{b()});const f=$(()=>d.value.reduce((x,s)=>x+parseFloat(s.heures),0)),m=$(()=>d.value.reduce((x,s)=>x+s.taux_horaire.taux*s.heures,0)),i=()=>{c("close")};return(x,s)=>(r(),n("div",ee,[e("div",te,[e("div",{class:"flex justify-between items-center pb-4 border-b border-gray-800"},[s[0]||(s[0]=e("h2",{class:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400"}," 🧾 Prestations ",-1)),e("button",{onClick:i,class:"text-gray-400 hover:text-white transition-transform hover:scale-110"}," ✕ ")]),e("div",se,[t(d).length===0?(r(),n("div",re,s[1]||(s[1]=[e("div",{class:"text-4xl mb-3"},"🎉",-1),e("p",{class:"text-gray-400"},"Aucune prestations !",-1)]))):(r(),n("div",oe,[(r(!0),n(P,null,A(t(d),p=>(r(),n("label",{key:p.id,class:"group flex items-center p-4 rounded-xl border border-gray-800 hover:border-indigo-500 bg-gray-800/50 cursor-pointer transition-all"},[e("div",ne,[e("div",ae,[e("span",le,a(t(z)(p.date)),1)]),e("div",ie,[e("div",de,[s[2]||(s[2]=e("span",{class:"text-gray-500"},"🕒",-1)),e("span",ue,a(p.heures)+"h",1)]),e("div",ce,[s[3]||(s[3]=e("span",{class:"text-gray-500"},"📍",-1)),e("span",ge,a(p.adresse),1)]),e("div",xe,[s[4]||(s[4]=e("span",{class:"text-gray-500"},"👤",-1)),e("span",fe,a(p.client.nom),1)]),e("div",be,[s[5]||(s[5]=e("span",{class:"text-gray-500"},"💰",-1)),e("span",me,a(p.taux_horaire.taux)+" € / h",1)])])])]))),128))]))]),t(d).length!==0?(r(),n("div",pe,[s[8]||(s[8]=e("h3",{class:"text-lg font-semibold text-white mb-3 flex items-center gap-2"}," 📝 Récapitulatif ",-1)),e("div",ve,[e("div",he,[s[6]||(s[6]=e("span",{class:"text-gray-400"},"Total heures :",-1)),e("span",ye,a(f.value)+"h",1)]),e("div",_e,[s[7]||(s[7]=e("span",{class:"text-gray-400"},"Montant HT :",-1)),e("span",$e,a(m.value)+" €",1)])])])):v("",!0)])]))}},ke={class:"fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-md z-50"},Ce={class:"bg-gray-900 p-8 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-auto border border-gray-800"},Se={class:"flex justify-between items-center pb-4 border-b border-gray-800"},Te={class:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400"},Fe={class:"mt-6 space-y-4"},Pe={key:0,class:"p-6 text-center rounded-xl border-2 border-dashed border-gray-800 hover:border-indigo-500 transition-colors"},je={key:1},Ae={class:"flex items-center justify-between pb-2 border-b border-gray-700"},De={class:"font-bold text-md bg-gray-900 text-gray-400 px-3 py-1 rounded-full"},Me=["onClick"],Be=["onClick","disabled"],Ne={key:0,class:"animate-spin border-4 border-white border-t-transparent rounded-full w-4 h-4"},Ve={class:"grid grid-cols-2 gap-4 mt-3 text-lg"},Re={class:"flex items-center gap-2 text-gray-300"},ze={class:"font-semibold"},He={class:"flex items-center gap-2 text-green-400"},Ue={class:"font-semibold"},qe={class:"mt-4 space-y-2"},Ie={class:"grid grid-cols-2 gap-4"},Le={class:"flex items-center gap-2 text-gray-400"},Ee={class:"font-semibold"},We={class:"flex items-center gap-2 text-gray-400"},Ge={class:"font-semibold"},Je={class:"flex items-center gap-2 text-gray-400"},Ke={class:"font-semibold"},Oe={class:"flex items-center gap-2 text-green-400"},Qe={class:"font-semibold"},Xe={key:0,class:"mt-6 bg-gray-800 p-4 rounded-xl border border-gray-700"},Ye={class:"space-y-2"},Ze={class:"flex justify-between items-center"},et={class:"text-indigo-400 font-bold"},tt={class:"flex justify-between items-center"},st={class:"text-green-400 font-bold"},V={__name:"FacturesModal",props:{factures:Array,title:String,required:!0},emits:["close"],setup(l,{emit:u}){const c=l,g=u,d=U(),{loading:b}=F(d),{paid:f}=d,m=S(null),i=$(()=>c.factures.reduce((C,o)=>C+parseFloat(o.heures_total),0)),x=$(()=>c.factures.reduce((C,o)=>C+o.montant_total,0));async function s(C){await f(C.id)}const p=()=>{g("close")};return(C,o)=>(r(),n("div",ke,[e("div",Ce,[e("div",Se,[e("h2",Te," 🧾 "+a(l.title),1),e("button",{onClick:p,class:"text-gray-400 hover:text-white transition-transform hover:scale-110"}," ✕ ")]),e("div",Fe,[l.factures.length===0?(r(),n("div",Pe,o[1]||(o[1]=[e("div",{class:"text-4xl mb-3"},"🎉",-1),e("p",{class:"text-gray-400"},"Aucune facture disponible.",-1)]))):(r(),n("div",je,[(r(!0),n(P,null,A(l.factures,h=>(r(),n("div",{key:h.id,class:"mt-2 bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700"},[e("div",Ae,[e("span",De," 📄 Facture #"+a(h.id),1),e("button",{onClick:_=>m.value=h.id,class:"bg-indigo-600 text-white px-3 py-1 rounded-lg text-sm hover:bg-indigo-500 transition"}," 📄 Voir PDF ",8,Me),h.statut==="en_attente_paiement"?(r(),n("button",{key:0,onClick:_=>s(h),disabled:t(b).paid,class:"btn-action bg-green-500 disabled:opacity-50"},[t(b).paid?(r(),n("span",Ne)):v("",!0),o[2]||(o[2]=w(" ✅ Payé "))],8,Be)):v("",!0)]),e("div",Ve,[e("div",Re,[o[3]||(o[3]=w(" 🕒 ")),e("span",ze,a(h.heures_total)+" h",1)]),e("div",He,[o[4]||(o[4]=w(" 💰 ")),e("span",Ue,a(h.montant_total)+" €",1)])]),e("div",qe,[o[9]||(o[9]=e("h3",{class:"text-md font-semibold text-gray-300 flex items-center gap-2"}," 📌 Prestations incluses : ",-1)),(r(!0),n(P,null,A(h.prestations,_=>(r(),n("div",{key:_.id,class:"bg-gray-800 p-3 rounded-lg border border-gray-700"},[e("div",Ie,[e("div",Le,[o[5]||(o[5]=w(" 📅 ")),e("span",Ee,a(t(z)(_.date)),1)]),e("div",We,[o[6]||(o[6]=w(" 🏢 ")),e("span",Ge,a(_.client.nom),1)]),e("div",Je,[o[7]||(o[7]=w(" ⏰ ")),e("span",Ke,a(_.heures)+" h",1)]),e("div",Oe,[o[8]||(o[8]=w(" 💵 ")),e("span",Qe,a(_.taux_horaire.taux)+" € / h",1)])])]))),128))]),m.value===h.id?(r(),T(q,{key:0,invoice:h,onClose:o[0]||(o[0]=_=>m.value=null)},null,8,["invoice"])):v("",!0)]))),128))]))]),l.factures.length!==0?(r(),n("div",Xe,[o[12]||(o[12]=e("h3",{class:"text-lg font-semibold text-white mb-3 flex items-center gap-2"}," 📝 Récapitulatif ",-1)),e("div",Ye,[e("div",Ze,[o[10]||(o[10]=e("span",{class:"text-gray-400"},"Total heures :",-1)),e("span",et,a(i.value)+" h",1)]),e("div",tt,[o[11]||(o[11]=e("span",{class:"text-gray-400"},"Montant HT :",-1)),e("span",st,a(x.value)+" €",1)])])])):v("",!0)])]))}},rt={class:"p-6 bg-gray-900 min-h-screen"},ot={class:"mb-8 flex flex-wrap gap-4 items-center"},nt={key:0,class:"text-center text-gray-300"},at={key:1,class:"text-center text-red-400"},lt={key:2},it={key:3,class:"text-center text-gray-400"},xt={__name:"Dashboard",setup(l){const u=D(),{dashboardData:c,period:g,taxe:d,loading:b,error:f}=F(u),{fetchDashboard:m}=u;function i(){m()}return R(()=>{m()}),(x,s)=>(r(),n("div",rt,[s[4]||(s[4]=e("h1",{class:"text-3xl font-bold text-white mb-8"},"Tableau de bord",-1)),e("div",ot,[e("div",null,[s[2]||(s[2]=e("label",{for:"period",class:"text-white font-semibold mr-2"},"Période :",-1)),M(e("input",{type:"month",id:"period","onUpdate:modelValue":s[0]||(s[0]=p=>N(g)?g.value=p:null),onChange:i,class:"p-2 rounded border border-gray-600 bg-gray-800 text-white"},null,544),[[B,t(g)]])]),e("div",null,[s[3]||(s[3]=e("label",{for:"taxe",class:"text-white font-semibold mr-2"},"Taxe (%) :",-1)),M(e("input",{type:"number",id:"taxe","onUpdate:modelValue":s[1]||(s[1]=p=>N(d)?d.value=p:null),min:"0",class:"p-2 rounded border border-gray-600 bg-gray-800 text-white w-24 text-center"},null,512),[[B,t(d)]])])]),t(b)?(r(),n("div",nt,"Chargement...")):t(f)?(r(),n("div",at,a(t(f)),1)):t(c)&&t(c).prestations&&t(c).prestations.length>0?(r(),n("div",lt,[y(t(E)),y(t(Z))])):(r(),n("div",it," 📉 Aucune donnée disponible pour ce mois. "))]))}};export{xt as default};
