import{k as ve,i as me,C as fe,D as de,B as ie,E as ye,h as q,G as $e,H as ge,I as Se,J as we,K as Me,c as U,L as Z,u as De,m as be,p as X}from"./app-CzuueUTO.js";function Oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var se={exports:{}},_e=se.exports,oe;function je(){return oe||(oe=1,function(e,a){(function(f,d){e.exports=d()})(_e,function(){var f=1e3,d=6e4,S=36e5,j="millisecond",D="second",h="minute",v="hour",p="day",O="week",y="month",N="quarter",k="year",Y="date",E="Invalid Date",F=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,o=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,$={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(u){var r=["th","st","nd","rd"],t=u%100;return"["+u+(r[(t-20)%10]||r[t]||r[0])+"]"}},_=function(u,r,t){var i=String(u);return!i||i.length>=r?u:""+Array(r+1-i.length).join(t)+u},J={s:_,z:function(u){var r=-u.utcOffset(),t=Math.abs(r),i=Math.floor(t/60),n=t%60;return(r<=0?"+":"-")+_(i,2,"0")+":"+_(n,2,"0")},m:function u(r,t){if(r.date()<t.date())return-u(t,r);var i=12*(t.year()-r.year())+(t.month()-r.month()),n=r.clone().add(i,y),c=t-n<0,l=r.clone().add(i+(c?-1:1),y);return+(-(i+(t-n)/(c?n-l:l-n))||0)},a:function(u){return u<0?Math.ceil(u)||0:Math.floor(u)},p:function(u){return{M:y,y:k,w:O,d:p,D:Y,h:v,m:h,s:D,ms:j,Q:N}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(u){return u===void 0}},P="en",x={};x[P]=$;var W="$isDayjsObject",G=function(u){return u instanceof M||!(!u||!u[W])},L=function u(r,t,i){var n;if(!r)return P;if(typeof r=="string"){var c=r.toLowerCase();x[c]&&(n=c),t&&(x[c]=t,n=c);var l=r.split("-");if(!n&&l.length>1)return u(l[0])}else{var m=r.name;x[m]=r,n=m}return!i&&n&&(P=n),n||!i&&P},w=function(u,r){if(G(u))return u.clone();var t=typeof r=="object"?r:{};return t.date=u,t.args=arguments,new M(t)},s=J;s.l=L,s.i=G,s.w=function(u,r){return w(u,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var M=function(){function u(t){this.$L=L(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[W]=!0}var r=u.prototype;return r.parse=function(t){this.$d=function(i){var n=i.date,c=i.utc;if(n===null)return new Date(NaN);if(s.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var l=n.match(F);if(l){var m=l[2]-1||0,g=(l[7]||"0").substring(0,3);return c?new Date(Date.UTC(l[1],m,l[3]||1,l[4]||0,l[5]||0,l[6]||0,g)):new Date(l[1],m,l[3]||1,l[4]||0,l[5]||0,l[6]||0,g)}}return new Date(n)}(t),this.init()},r.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},r.$utils=function(){return s},r.isValid=function(){return this.$d.toString()!==E},r.isSame=function(t,i){var n=w(t);return this.startOf(i)<=n&&n<=this.endOf(i)},r.isAfter=function(t,i){return w(t)<this.startOf(i)},r.isBefore=function(t,i){return this.endOf(i)<w(t)},r.$g=function(t,i,n){return s.u(t)?this[i]:this.set(n,t)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(t,i){var n=this,c=!!s.u(i)||i,l=s.p(t),m=function(R,T){var I=s.w(n.$u?Date.UTC(n.$y,T,R):new Date(n.$y,T,R),n);return c?I:I.endOf(p)},g=function(R,T){return s.w(n.toDate()[R].apply(n.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(T)),n)},b=this.$W,A=this.$M,H=this.$D,V="set"+(this.$u?"UTC":"");switch(l){case k:return c?m(1,0):m(31,11);case y:return c?m(1,A):m(0,A+1);case O:var z=this.$locale().weekStart||0,B=(b<z?b+7:b)-z;return m(c?H-B:H+(6-B),A);case p:case Y:return g(V+"Hours",0);case v:return g(V+"Minutes",1);case h:return g(V+"Seconds",2);case D:return g(V+"Milliseconds",3);default:return this.clone()}},r.endOf=function(t){return this.startOf(t,!1)},r.$set=function(t,i){var n,c=s.p(t),l="set"+(this.$u?"UTC":""),m=(n={},n[p]=l+"Date",n[Y]=l+"Date",n[y]=l+"Month",n[k]=l+"FullYear",n[v]=l+"Hours",n[h]=l+"Minutes",n[D]=l+"Seconds",n[j]=l+"Milliseconds",n)[c],g=c===p?this.$D+(i-this.$W):i;if(c===y||c===k){var b=this.clone().set(Y,1);b.$d[m](g),b.init(),this.$d=b.set(Y,Math.min(this.$D,b.daysInMonth())).$d}else m&&this.$d[m](g);return this.init(),this},r.set=function(t,i){return this.clone().$set(t,i)},r.get=function(t){return this[s.p(t)]()},r.add=function(t,i){var n,c=this;t=Number(t);var l=s.p(i),m=function(A){var H=w(c);return s.w(H.date(H.date()+Math.round(A*t)),c)};if(l===y)return this.set(y,this.$M+t);if(l===k)return this.set(k,this.$y+t);if(l===p)return m(1);if(l===O)return m(7);var g=(n={},n[h]=d,n[v]=S,n[D]=f,n)[l]||1,b=this.$d.getTime()+t*g;return s.w(b,this)},r.subtract=function(t,i){return this.add(-1*t,i)},r.format=function(t){var i=this,n=this.$locale();if(!this.isValid())return n.invalidDate||E;var c=t||"YYYY-MM-DDTHH:mm:ssZ",l=s.z(this),m=this.$H,g=this.$m,b=this.$M,A=n.weekdays,H=n.months,V=n.meridiem,z=function(T,I,K,Q){return T&&(T[I]||T(i,c))||K[I].slice(0,Q)},B=function(T){return s.s(m%12||12,T,"0")},R=V||function(T,I,K){var Q=T<12?"AM":"PM";return K?Q.toLowerCase():Q};return c.replace(o,function(T,I){return I||function(K){switch(K){case"YY":return String(i.$y).slice(-2);case"YYYY":return s.s(i.$y,4,"0");case"M":return b+1;case"MM":return s.s(b+1,2,"0");case"MMM":return z(n.monthsShort,b,H,3);case"MMMM":return z(H,b);case"D":return i.$D;case"DD":return s.s(i.$D,2,"0");case"d":return String(i.$W);case"dd":return z(n.weekdaysMin,i.$W,A,2);case"ddd":return z(n.weekdaysShort,i.$W,A,3);case"dddd":return A[i.$W];case"H":return String(m);case"HH":return s.s(m,2,"0");case"h":return B(1);case"hh":return B(2);case"a":return R(m,g,!0);case"A":return R(m,g,!1);case"m":return String(g);case"mm":return s.s(g,2,"0");case"s":return String(i.$s);case"ss":return s.s(i.$s,2,"0");case"SSS":return s.s(i.$ms,3,"0");case"Z":return l}return null}(T)||l.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(t,i,n){var c,l=this,m=s.p(i),g=w(t),b=(g.utcOffset()-this.utcOffset())*d,A=this-g,H=function(){return s.m(l,g)};switch(m){case k:c=H()/12;break;case y:c=H();break;case N:c=H()/3;break;case O:c=(A-b)/6048e5;break;case p:c=(A-b)/864e5;break;case v:c=A/S;break;case h:c=A/d;break;case D:c=A/f;break;default:c=A}return n?c:s.a(c)},r.daysInMonth=function(){return this.endOf(y).$D},r.$locale=function(){return x[this.$L]},r.locale=function(t,i){if(!t)return this.$L;var n=this.clone(),c=L(t,i,!0);return c&&(n.$L=c),n},r.clone=function(){return s.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},u}(),C=M.prototype;return w.prototype=C,[["$ms",j],["$s",D],["$m",h],["$H",v],["$W",p],["$M",y],["$y",k],["$D",Y]].forEach(function(u){C[u[1]]=function(r){return this.$g(r,u[0],u[1])}}),w.extend=function(u,r){return u.$i||(u(r,M,w),u.$i=!0),w},w.locale=L,w.isDayjs=G,w.unix=function(u){return w(1e3*u)},w.en=x[P],w.Ls=x,w.p={},w})}(se)),se.exports}var ke=je();const he=Oe(ke),ee=ve();function te(e,a){e==="success"?ee.success(a):e==="error"?ee.error(a):e==="info"?ee.info(a):e==="warning"&&ee.warning(a)}function Be(e){return he(e).format("DD/MM/YYYY")}function Ke(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function Ae(e){return Se()?(we(e),!0):!1}const Ce=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Te=Object.prototype.toString,Ye=e=>Te.call(e)==="[object Object]",xe=()=>{};function Ee(e,a){function f(...d){return new Promise((S,j)=>{Promise.resolve(e(()=>a.apply(this,d),{fn:a,thisArg:this,args:d})).then(S).catch(j)})}return f}const pe=e=>e();function Fe(e=pe,a={}){const{initialState:f="active"}=a,d=He(f==="active");function S(){d.value=!1}function j(){d.value=!0}const D=(...h)=>{d.value&&e(...h)};return{isActive:de(d),pause:S,resume:j,eventFilter:D}}function We(e){return ge()}function ae(e){return Array.isArray(e)?e:[e]}function He(...e){if(e.length!==1)return ye(...e);const a=e[0];return typeof a=="function"?de($e(()=>({get:a,set:xe}))):q(a)}function Ne(e,a,f={}){const{eventFilter:d=pe,...S}=f;return ie(e,Ee(d,a),S)}function Pe(e,a,f={}){const{eventFilter:d,initialState:S="active",...j}=f,{eventFilter:D,pause:h,resume:v,isActive:p}=Fe(d,{initialState:S});return{stop:Ne(e,a,{...j,eventFilter:D}),pause:h,resume:v,isActive:p}}function Le(e,a=!0,f){We()?me(e,f):a?e():fe(e)}function Je(e,a,f){return ie(e,a,{...f,immediate:!0})}const ue=Ce?window:void 0;function Ie(e){var a;const f=Z(e);return(a=f==null?void 0:f.$el)!=null?a:f}function ce(...e){const a=[],f=()=>{a.forEach(h=>h()),a.length=0},d=(h,v,p,O)=>(h.addEventListener(v,p,O),()=>h.removeEventListener(v,p,O)),S=U(()=>{const h=ae(Z(e[0])).filter(v=>v!=null);return h.every(v=>typeof v!="string")?h:void 0}),j=Je(()=>{var h,v;return[(v=(h=S.value)==null?void 0:h.map(p=>Ie(p)))!=null?v:[ue].filter(p=>p!=null),ae(Z(S.value?e[1]:e[0])),ae(De(S.value?e[2]:e[1])),Z(S.value?e[3]:e[2])]},([h,v,p,O])=>{if(f(),!(h!=null&&h.length)||!(v!=null&&v.length)||!(p!=null&&p.length))return;const y=Ye(O)?{...O}:O;a.push(...h.flatMap(N=>v.flatMap(k=>p.map(Y=>d(N,k,Y,y)))))},{flush:"post"}),D=()=>{j(),f()};return Ae(f),D}const ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},re="__vueuse_ssr_handlers__",ze=Re();function Re(){return re in ne||(ne[re]=ne[re]||{}),ne[re]}function Ve(e,a){return ze[e]||a}function qe(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Ue={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},le="vueuse-storage";function Ze(e,a,f,d={}){var S;const{flush:j="pre",deep:D=!0,listenToStorageChanges:h=!0,writeDefaults:v=!0,mergeDefaults:p=!1,shallow:O,window:y=ue,eventFilter:N,onError:k=s=>{console.error(s)},initOnMounted:Y}=d,E=(O?Me:q)(typeof a=="function"?a():a),F=U(()=>Z(e));if(!f)try{f=Ve("getDefaultStorage",()=>{var s;return(s=ue)==null?void 0:s.localStorage})()}catch(s){k(s)}if(!f)return E;const o=Z(a),$=qe(o),_=(S=d.serializer)!=null?S:Ue[$],{pause:J,resume:P}=Pe(E,()=>W(E.value),{flush:j,deep:D,eventFilter:N});ie(F,()=>L(),{flush:j}),y&&h&&Le(()=>{f instanceof Storage?ce(y,"storage",L,{passive:!0}):ce(y,le,w),Y&&L()}),Y||L();function x(s,M){if(y){const C={key:F.value,oldValue:s,newValue:M,storageArea:f};y.dispatchEvent(f instanceof Storage?new StorageEvent("storage",C):new CustomEvent(le,{detail:C}))}}function W(s){try{const M=f.getItem(F.value);if(s==null)x(M,null),f.removeItem(F.value);else{const C=_.write(s);M!==C&&(f.setItem(F.value,C),x(M,C))}}catch(M){k(M)}}function G(s){const M=s?s.newValue:f.getItem(F.value);if(M==null)return v&&o!=null&&f.setItem(F.value,_.write(o)),o;if(!s&&p){const C=_.read(M);return typeof p=="function"?p(C,o):$==="object"&&!Array.isArray(C)?{...o,...C}:C}else return typeof M!="string"?M:_.read(M)}function L(s){if(!(s&&s.storageArea!==f)){if(s&&s.key==null){E.value=o;return}if(!(s&&s.key!==F.value)){J();try{(s==null?void 0:s.newValue)!==_.write(E.value)&&(E.value=G(s))}catch(M){k(M)}finally{s?fe(P):P()}}}}function w(s){L(s.detail)}return E}const Qe=be("prestations",()=>{const e=q([]),a=q({}),f=q({}),d=Ze("prestation-filters",{month_year:""});function S(o){d.value=o}const j=U(()=>Object.values(d.value).some(o=>o!=="")),D=q([]);ie([e,d],()=>{D.value=e.value.filter(o=>{const{month_year:$}=d.value;return!($&&he(o.date).format("YYYY-MM")!==$)})},{deep:!0,immediate:!0});const h=U(()=>D.value.length),v=U(()=>D.value.reduce((o,$)=>o+$.heures,0)),p=U(()=>e.value.filter(o=>!o.facture_id));function O(o){o?a.value[o]=null:a.value={}}function y(o,$){f.value[o]=$}async function N({operation:o,request:$,onSuccess:_}){var J,P,x;O(o),y(o,!0);try{const W=await $();return _&&_(W),W}catch(W){throw((J=W.response)==null?void 0:J.status)===422?a.value.validationErrors=W.response.data.errors:(a.value[o]=((x=(P=W.response)==null?void 0:P.data)==null?void 0:x.message)||"Une erreur est survenue.",te("error",a.value[o])),W}finally{y(o,!1)}}async function k(){return N({operation:"fetch",request:()=>X.get("/api/prestations"),onSuccess:o=>{e.value=o.data}})}async function Y(o){return N({operation:"add",request:()=>X.post("/api/prestations",o),onSuccess:$=>{e.value.push($.data),te("success",$.data.message||"Prestation ajoutée avec succès.")}})}async function E(o){return N({operation:"update",request:()=>X.put(`/api/prestations/${o.id}`,o),onSuccess:$=>{const _=e.value.findIndex(J=>J.id===o.id);_!==-1&&(e.value[_]=$.data.data||$.data),te("success",$.data.message||"Prestation mise à jour avec succès.")}})}async function F(o){return N({operation:"delete",request:()=>X.delete(`/api/prestations/${o}`),onSuccess:$=>{e.value=e.value.filter(_=>_.id!==o),te("success",$.data.message||"Prestation supprimée avec succès.")}})}return{prestations:e,errors:a,loading:f,activeFilters:d,updateFilters:S,filteredPrestations:D,isAnyFilterActive:j,fetchPrestations:k,addPrestation:Y,updatePrestation:E,deletePrestation:F,clearErrors:O,prestationCount:h,totalHours:v,unbilledPrestations:p}});export{he as d,Be as f,te as n,Qe as u,Ke as v};
